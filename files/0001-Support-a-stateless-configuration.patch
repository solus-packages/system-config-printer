From 7c3cee968163678dae5554e135e07836ee8950ee Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Thu, 17 Mar 2016 01:22:27 +0000
Subject: [PATCH] Support a stateless configuration

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 Makefile.am              | 5 +++--
 cupshelpers/config.py.in | 1 +
 cupshelpers/ppds.py      | 2 +-
 3 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index 10eb32d..49b605e 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -49,6 +49,7 @@ cupshelpers/config.py: cupshelpers/config.py.in Makefile
 	sed \
 	  -e "s|\@prefix\@|$(prefix)|" \
 	  -e "s|\@sysconfdir\@|$(sysconfdir)|" \
+	  -e "s|\@datadir\@|$(datadir)|" \
 	  -e "s|\@cupsserverbindir\@|$(cupsserverbindir)|" \
 	  $< > $@
 
@@ -170,7 +171,7 @@ nobase_pkgdata_DATA=					\
 	xml/preferreddrivers.rng			\
 	xml/validate.py
 
-cupshelpersdir=$(sysconfdir)/cupshelpers
+cupshelpersdir=$(datadir)/cupshelpers
 cupshelpers_DATA=\
 	xml/preferreddrivers.xml
 
@@ -227,7 +228,7 @@ desktop_DATA =\
 	system-config-printer.desktop \
 	print-applet.desktop
 desktopdir = $(datadir)/applications/
-autostartdir = $(sysconfdir)/xdg/autostart/
+autostartdir = $(datadir)/xdg/autostart/
 
 DESKTOP_VENDOR=@DESKTOPVENDOR@
 DESKTOP_PREFIX=@DESKTOPPREFIX@
diff --git a/cupshelpers/config.py.in b/cupshelpers/config.py.in
index 55abbfc..1a6e84f 100644
--- a/cupshelpers/config.py.in
+++ b/cupshelpers/config.py.in
@@ -21,4 +21,5 @@
 
 prefix="@prefix@"
 sysconfdir="@sysconfdir@"
+datadir="@datadir@"
 cupsserverbindir="@cupsserverbindir@"
diff --git a/cupshelpers/ppds.py b/cupshelpers/ppds.py
index a576c8b..3ee1e38 100755
--- a/cupshelpers/ppds.py
+++ b/cupshelpers/ppds.py
@@ -348,7 +348,7 @@ class PPDs:
             xml_dir = os.environ.get ("CUPSHELPERS_XMLDIR")
             if xml_dir == None:
                 from . import config
-                xml_dir = os.path.join (config.sysconfdir, "cupshelpers")
+                xml_dir = os.path.join (config.datadir, "cupshelpers")
 
         try:
             xmlfile = os.path.join (xml_dir, "preferreddrivers.xml")
-- 
2.7.3

